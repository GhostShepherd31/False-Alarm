<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>False Alarm — Compatibility Scoring</title>
  <style>
    :root{
      --bg:#0b1020;--card:#121a33;--muted:#9aa3c9;--text:#e9eeff;
      --life:#6dd47e; --gf:#d2b94b; --fwb:#ffe86b; --one:#ff9f45; --danger:#ff4b4b;
    }
    body{margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:var(--text)}
    .container{max-width:1100px;margin:24px auto;padding:0 16px}
    h1{margin:0 0 10px;font-size:28px}
    .card{background:#121a33;border:1px solid #2a345f;border-radius:12px;padding:16px;margin-bottom:18px}
    table{width:100%;border-collapse:separate;border-spacing:0 6px}
    thead th{font-size:.85rem;color:var(--muted);text-align:left}
    td,th{padding:6px 8px}
    select,input[type=number]{background:#0e1530;color:var(--text);border:1px solid #2b3561;border-radius:8px;padding:4px;width:100%}
    .btn{padding:6px 10px;border-radius:8px;border:none;cursor:pointer}
    .btn.danger{background:#2b1930;color:#fff}
    .score{font-size:40px;font-weight:bold;margin:10px 0}
    .band{font-weight:bold;font-size:18px}
    .meter{height:18px;background:#0f1836;border-radius:8px;overflow:hidden;margin-top:6px}
    .meter>div{height:100%;width:0}
    .tag{display:inline-block;padding:4px 8px;margin:4px;border-radius:6px;font-size:.9rem}
  </style>
</head>
<body>
  <div class="container">
    <h1>False Alarm</h1>

    <section class="card">
      <h2>Good Traits (20 max)</h2>
      <table>
        <thead>
          <tr><th>Trait</th><th>Standard</th><th>Partner Rating</th><th>Weighted</th><th></th></tr>
        </thead>
        <tbody id="qualities-body"></tbody>
        <tfoot>
          <tr><td colspan="3" style="text-align:right">Total Compatibility</td><td id="total-compat">0</td><td></td></tr>
        </tfoot>
      </table>
      <input id="new-quality" placeholder="Add quality" /> <button class="btn" id="add-quality">Add</button>
    </section>

    <section class="card">
      <h2>Red Flags</h2>
      <table>
        <thead>
          <tr><th>Red Flag</th><th>Present?</th><th>Penalty</th><th></th></tr>
        </thead>
        <tbody id="flags-body"></tbody>
        <tfoot>
          <tr><td colspan="2" style="text-align:right">Dealbreaker Penalty</td><td id="total-penalty">0</td><td></td></tr>
        </tfoot>
      </table>
      <input id="new-flag" placeholder="Add red flag" /> <input id="new-pen" type="number" placeholder="Penalty" /> <button class="btn danger" id="add-flag">Add</button>
    </section>

    <section class="card">
      <h2>Final Result</h2>
      <div class="score" id="final-score">0 / 500</div>
      <div class="meter"><div id="meter-bar"></div></div>
      <div class="band" id="band">—</div>
      <div>
        <span class="tag" style="background:var(--life)">Life Partner 450–500</span>
        <span class="tag" style="background:var(--gf)">Potential GF/BF 300–450</span>
        <span class="tag" style="background:var(--fwb)">Friend w Benefits 100–299</span>
        <span class="tag" style="background:var(--one)">One time only 50–99</span>
        <span class="tag" style="background:var(--danger)">Stay Away 0–49</span>
      </div>
    </section>
  </div>

<script>
const STANDARD = 5;
const MAX_TRAITS = 20;
const DEFAULT_FLAGS = [["Poor hygiene", -200],["Substance abuse", -300],["Criminal activity", -500]];
let state = {qualities:[],flags:[]};

function render(){
  const qBody=document.getElementById('qualities-body');
  qBody.innerHTML='';
  state.qualities.forEach((q,i)=>{
    qBody.innerHTML+=`<tr><td>${q.name}</td><td>5</td><td><select data-i="${i}" class="rating">${[1,2,3,4,5].map(v=>`<option ${q.rating==v?'selected':''}>${v}</option>`).join('')}</select></td><td>${STANDARD*q.rating}</td><td><button onclick="removeQ(${i})">X</button></td></tr>`;
  });
  const fBody=document.getElementById('flags-body');
  fBody.innerHTML='';
  state.flags.forEach((f,i)=>{
    fBody.innerHTML+=`<tr><td>${f.name}</td><td><input type=checkbox data-i="${i}" class="flag" ${f.present?'checked':''}></td><td>${f.penalty}</td><td><button onclick="removeF(${i})">X</button></td></tr>`;
  });
  compute();
}
function compute(){
  const totalCompat=state.qualities.reduce((s,q)=>s+STANDARD*q.rating,0);
  const totalPenalty=state.flags.reduce((s,f)=>s+(f.present?f.penalty:0),0);
  const final=Math.max(0,totalCompat+totalPenalty);
  document.getElementById('total-compat').textContent=totalCompat;
  document.getElementById('total-penalty').textContent=totalPenalty;
  document.getElementById('final-score').textContent=`${final} / 500`;
  document.getElementById('meter-bar').style.width=(final/500*100)+"%";
  document.getElementById('meter-bar').style.background=color(final);
  document.getElementById('band').textContent=band(final);
}
function band(s){
  if(s>=450) return 'Life Partner';
  if(s>=300) return 'Potential GF/BF';
  if(s>=100) return 'Friend w Benefits';
  if(s>=50) return 'One time only';
  return 'Stay Away';
}
function color(s){
  if(s>=450) return getComputedStyle(document.documentElement).getPropertyValue('--life');
  if(s>=300) return getComputedStyle(document.documentElement).getPropertyValue('--gf');
  if(s>=100) return getComputedStyle(document.documentElement).getPropertyValue('--fwb');
  if(s>=50) return getComputedStyle(document.documentElement).getPropertyValue('--one');
  return getComputedStyle(document.documentElement).getPropertyValue('--danger');
}

// Events
addEventListener('change',e=>{
  if(e.target.classList.contains('rating')){
    state.qualities[e.target.dataset.i].rating=Number(e.target.value);
    render();
  }
  if(e.target.classList.contains('flag')){
    state.flags[e.target.dataset.i].present=e.target.checked;
    render();
  }
});
function removeQ(i){state.qualities.splice(i,1);render();}
function removeF(i){state.flags.splice(i,1);render();}

document.getElementById('add-quality').onclick=()=>{
  const name=document.getElementById('new-quality').value.trim();
  if(!name||state.qualities.length>=MAX_TRAITS) return;
  state.qualities.push({name,rating:5});
  document.getElementById('new-quality').value='';
  render();
};

document.getElementById('add-flag').onclick=()=>{
  const name=document.getElementById('new-flag').value.trim();
  let pen=Number(document.getElementById('new-pen').value||-100);
  if(!name) return;
  if(pen>0) pen=-pen;
  state.flags.push({name,penalty:pen,present:false});
  document.getElementById('new-flag').value='';
  document.getElementById('new-pen').value='';
  render();
};

// Init
defaultInit();
function defaultInit(){
  state.qualities=[];
  state.flags=DEFAULT_FLAGS.map(f=>({name:f[0],penalty:f[1],present:false}));
  render();
}
</script>
</body>
</html>
